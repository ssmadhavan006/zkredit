# ZKredit Mock Oracle Documentation

## Overview

The ZKredit Mock Oracle is a crucial component for the development and demonstration of the ZKredit protocol. It's a backend server that simulates a real-world financial institution's API, providing mock user financial data. For the purposes of the ZKredit demo, this oracle acts as a trusted data source, attesting to the validity of a user's financial information by signing it with a private key.

## Technology Stack

-   **Runtime:** Node.js
-   **Framework:** Express.js
-   **Cryptography:** `ethers.js` for cryptographic signing (ECDSA).

## Getting Started

### Prerequisites

-   Node.js v18+
-   `npm` (or a compatible package manager)

### Installation

1.  Navigate to the project root directory.
2.  Install dependencies:
    ```bash
    npm install
    ```

### Running the Oracle

To start the mock oracle server, run the following command from the project root:

```bash
npm run dev:oracle
```

The server will start on `http://localhost:3001` by default.

## API Endpoints

The mock oracle exposes the following RESTful API endpoints:

### `GET /api/users`

-   **Description:** Retrieves a list of all available mock users. This is useful for selecting a user profile to interact with in a demo environment.
-   **Response Body:** An array of user objects.
    ```json
    [
        { "id": 1, "name": "Alice" },
        { "id": 2, "name": "Bob" },
        { "id": 3, "name": "Charlie" }
    ]
    ```

### `GET /api/financial-data`

-   **Description:** Retrieves financial data for a specified user ID. Crucially, it also returns a cryptographic signature (attestation) of this data. This signature is generated by the "bank's" private key, allowing a smart contract to verify the data's authenticity without a traditional oracle service.
-   **Query Parameters:**
    -   `userId` (required): The ID of the user whose data is being requested.
-   **Success Response (200 OK):**
    ```json
    {
        "userId": 1,
        "income": 120000,
        "debt": 25000,
        "creditScore": 750,
        "signature": "0x..."
    }
    ```
-   **Error Response (404 Not Found):**
    ```json
    {
        "error": "User not found"
    }
    ```

## Cryptographic Attestation

The signature included in the `/api/financial-data` response is the core of the mock oracle's function.

-   **Signing Process:** The server hashes the user's financial data (`income`, `debt`, `creditScore`) and signs that hash using a pre-defined private key (`BANK_WALLET` in `server.js`).
-   **Verification:** The ZKredit smart contracts can then use `ecrecover` to derive the signer's public address from the message hash and the provided signature. If this address matches the authorized bank address stored in the `SecurityRegistry` contract, the data is considered authentic. This allows for a secure, off-chain data attestation process that is verifiable on-chain.
